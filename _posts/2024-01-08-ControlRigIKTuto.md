---
layout: post
categories: blog
title: 컨트롤 릭 IK 듀토리얼
date: 2024-01-08
tags: [UnrealEngine,Unreal,UE5,개인프로젝트,ControlRigIK]
toc:  true
---

컨트롤릭을 통한 IK적용은 기존에 애니메이션 인스턴스 내부에서 적용하던 방식과 비슷하다.
1. 내가 IK를 적용하길 원하는 본에서
2. 라인트레이스를 쏴서
3. 히트한 좌표를 이용해
4. 본을 움직인다

두가지 경우로 나눌 것이다.
1. IK본이 이미 있는 경우
2. IK본이 없는 경우

## 공통 준비
일단 어떠한 경우든, 라인트레이스는 본마다 쏴야 하니까, 재사용하기 편하도록 함수로 만들어 처리하도록 하자.

![ex_screenshot](/assets/images/unreal/myProject/24.01.08/rig_trace.png)


입력을 "릭 엘리먼트 키"를 파라미터로 받는다.
이 변수는 릭에 이용할 수 있는 여러 타입이 있는데, 어떤 타입을 이용할 것인지
그리고 그 타입과 일치하는 것의 이름이 무엇인지 받을 수 있다.

1. 받아온 타입과 이름을 가지고, 특정 본의 트랜스폼 정보를 가져온다.
2. 라인트레이스가 시작할 좌표를 구한다. 본의 위치에서 30만큼 위로 올린 지점을 구했다. (Add로 5만큼 Y값을 더해주고 있는데, 굳이 없어도 될 듯?)
3. 라인트레이스가 끝날 좌표를 구한다. 본의 위치에서 100만큼 아래 지점을 구했다.
4. 구한 좌표로 SphereTrace 한 뒤, 결과로 나온 히트 로케이션을 리턴한다.

이렇게 생성된 함수는, 다른 캐릭터의 ControlRig에서도 불러 사용할 수 있더라

## IK본이 있는 경우

## IK본이 없는 경우
